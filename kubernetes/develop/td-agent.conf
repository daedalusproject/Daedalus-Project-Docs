<source>
  @type forward
  bind 0.0.0.0
  port 9880
</source>

<match tail.0 >
  @type copy
  <store>
    @type s3
    aws_key_id _@_AWS_KEY_ID_@_
    aws_sec_key _@_AWS_SECRET_KEY_@_
    s3_bucket _@_S3_BUCKET_NAME_@_
    s3_region eu-west-1
    path develop-logs/
    <buffer tag,time>
      @type file
      path /tmp/fluents3
      timekey 3600 # 1 hour partition
      timekey_wait 10m
      timekey_use_utc true # use utc
      chunk_limit_size 256m
    </buffer>
  </store>
  <store>
    @type elasticsearch
    host _@_ELASTICSEARCH_HOST_@_
    port 9200
    user _@_ELASTICSEARCH_USER_@_
    password _@_ELASTICSEARCH_PASSWORD_@_
    index_name _@_ELASTICSEARCH_INDEX_@_
    pipeline geoip
  </store>
</match>

